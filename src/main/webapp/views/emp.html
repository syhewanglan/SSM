<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <!-- 导入样式 -->
    <link rel="stylesheet" type="text/css" href="https://www.layuicdn.com/layui/css/layui.css" />
    <!-- 导入 jquery -->
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
</head>
<body>
<form class="layui-form">
    <div style="width: 350px; float:left;">
        <div class="layui-form-item">
            <label class="layui-form-label">职员编号</label>
            <div class="layui-input-inline">
                <input type="text" name="employeeId" id="employeeId"  placeholder="输入职员名称" class="layui-input">
            </div>
        </div>
    <div class="layui-form-item">
        <label class="layui-form-label">职员姓名</label>
        <div class="layui-input-inline">
            <input type="text" name="employeeName" id="employeeName"  placeholder="输入职员名称" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">年龄</label>
        <div class="layui-input-inline">
            <input type="text" name="employeeAge" id="employeeAge"  placeholder="输入你的年龄" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">出生日期</label>
        <div class="layui-input-inline">
            <input type="text" name="employeeBirthDate" id="employeeBirthDate"  placeholder="输入出生日期" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label" style="padding-left: 0px;text-align: right;width: 95px;">加入公司时间</label>
        <div class="layui-input-inline">
            <input type="text" name="employeeJoinDate" id="employeeJoinDate"  placeholder="加入公司的时间" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">所任职务</label>
        <div class="layui-input-inline">
            <select name="jobsId" id="jobsId">
                <option value="">选择职务</option>
            </select>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">移动电话</label>
        <div class="layui-input-inline">
            <input type="text" name="employeeMobile" id="employeeMobile" placeholder="输入移动电话" class="layui-input">
        </div>
    </div>
    </div>
    <div style="width: 500px; float:left;">

    <div class="layui-form-item">
        <label class="layui-form-label">性别</label>
        <div class="layui-input-inline">
            <select name="employeeSex" id="employeeSex" lay-filter="aihao">
                <option value="">选择性别</option>
                <option value="男" selected>男</option>
                <option value="女">女</option>
            </select>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">身份证号</label>
        <div class="layui-input-inline" style="width: 280px;">
            <input type="text" name="employeeIdenCard" id="employeeIdenCard" placeholder="输入身份正号" class="layui-input">
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">学历</label>
        <div class="layui-input-inline">
            <select name="employeeDiploma" id="employeeDiploma" lay-filter="aihao">
                <option value="">选择学历</option>
            </select>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">所属部门</label>
        <div class="layui-input-inline">
            <select name="departmentId" id="departmentId" lay-filter="aihao">
                <option value="">选择部门</option>
            </select>
        </div>
    </div>
    <div class="layui-form-item">
        <label class="layui-form-label">固定电话</label>
        <div class="layui-input-inline">
            <input type="text" name="employeePhone" id="employeePhone" placeholder="输入固定电话" class="layui-input">
        </div>
    </div>
    </div>
    <dvi>
        <div class="layui-form-item">
            <label class="layui-form-label">家庭住址</label>
            <div class="layui-input-inline" style="width: 500px;">
                <input type="text" name="employeeAdd" id="employeeAdd"  placeholder="输入家庭地址" class="layui-input">
            </div>
        </div>
    </dvi>



    <div class="layui-form-item" style="margin: auto 0;">
        <div class="layui-input-block">
            <button type="submit" class="layui-btn"  lay-submit="" lay-filter="add">立即提交</button>
            <button type="reset" class="layui-btn layui-btn-primary">重置</button>
        </div>
    </div>
</form>

</body>
</html>
<script src="layer.js"></script>
<script src="https://www.layuicdn.com/layui/layui.js"></script>
<script>
    layui.use(['jquery','layer','form','laydate'],function(){
        var $=layui.jquery;
        var form=layui.form;
        var layer=layui.layer;
        var laydate=layui.laydate;

        //加载日期选择器
        loadLaydate(laydate);
        //加载下拉框
        loadSelect($,form);

        form.on('submit(add)',function (obj) {
            var field = obj.field;
            var pattern = /^((\d{3}-\d{8}|\d{4}-\d{7,8})|(1[3|5|7|8][0-9]{9}))$/;
            var valueYZM = $("#valuesYZM").text().replace(/\s+/g, "").toLowerCase();
             if(field.employeeId==""){
                layer.msg('职员编号不能为空!', {icon: 5, time: 1000, anim: 6}, function () {
                    $("input[name='employeeId']").focus();
                    return false;
                });
            }else if (field.employeeId!=5 && isNaN(field.employeeId)) {
                 layer.msg('编号必须5位数值!', {icon: 5, time: 1000, anim: 6}, function () {
                     $("input[name='employeeName']").focus();
                     return false;
                 });
             }else if (field.employeeName == "") {
                layer.msg('职员姓名不能为空!', {icon: 5, time: 1000, anim: 6}, function () {
                    $("input[name='employeeName']").focus();
                    return false;
                });
            } else if (field.employeeAge == "") {
                layer.msg('年龄不为空空', {icon: 5, time: 1000, anim: 6}, function () {
                    $("input[name='employeeAge']").focus();
                    return false;
                });
                return false;
            } else if (isNaN(field.employeeAge)) {
                layer.msg('年龄只能为正数值!', {icon: 5, time: 1000, anim: 6}, function () {
                    $("input[name='employeeAge']").focus();
                    return false;
                });
            } else if (field.employeeBirthDate == "") {
                layer.msg('出生日期不能为空!', {icon: 5, time: 1000, anim: 6}, function () {
                    $("input[name='employeeBirthDate']").focus();
                    return false;
                });
            }else if (field.employeeJoinDate == "") {
                layer.msg('加入公司时间不能为空!', {icon: 5, time: 1000, anim: 6}, function () {
                    $("input[name='employeeJoinDate']").focus();
                    return false;
                });
            }else if (field.jobsId == "") {
                layer.msg('职务未选择!', {icon: 5, time: 1000, anim: 6}, function () {
                    return false;
                });
            }else if (field.employeeMobile == "") {
                layer.msg('移动手机号不能为空!', {icon: 5, time: 1000, anim: 6}, function () {
                    $("input[name='employeeMobile']").focus();
                    return false;
                });
            }else if (!pattern.test(field.employeeMobile)) {
                layer.msg('移动手机号格式不正确!', {icon: 5, time: 1000, anim: 6}, function () {
                    $("input[name='employeeMobile']").focus();
                    return false;
                });
            }else if (field.employeeSex=="") {
                layer.msg('性别未选择!', {icon: 5, time: 1000, anim: 6}, function () {
                    return false;
                });
            }else if (field.employeeIdenCard.length != 18) {
                layer.msg('身份证必须18位!', {icon: 5, time: 1000, anim: 6}, function () {
                    $("input[name='employeeIdenCard']").focus();
                    return false;
                });
            }else if (field.employeeDiploma=="") {
                layer.msg('学历未选择!', {icon: 5, time: 1000, anim: 6}, function () {
                    return false;
                });
            }else if (field.departmentId=="") {
                layer.msg('部门未选择!', {icon: 5, time: 1000, anim: 6}, function () {
                    return false;
                });
            }else if (field.employeePhone=="") {
                layer.msg('固定手机号不能为空!', {icon: 5, time: 1000, anim: 6}, function () {
                    $("input[name='employeePhone']").focus();
                    return false;
                });
            }else if (!pattern.test(field.employeePhone)) {
                layer.msg('固定手机号格式不正确!', {icon: 5, time: 1000, anim: 6}, function () {
                    $("input[name='employeePhone']").focus();
                    return false;
                });
            }else if (field.employeeAdd.length>50) {
                layer.msg('家庭地址最多50个字符!', {icon: 5, time: 1000, anim: 6}, function () {
                    $("input[name='employeeAdd']").focus();
                    return false;
                });
            }else{
                var obj={
                    EmployeeId:field.employeeId, //职员Id
                    EmployeeName:field.employeeName,//职员姓名
                    EmployeeSex:field.employeeSex,//职员性别
                    EmployeeAge:field.employeeAge,//职员年龄
                    EmployeeIdenCard:field.employeeIdenCard,//职员身份证号
                    EmployeeBirthDate:field.employeeBirthDate,//职员出生日期
                    EmployeeDiploma:field.employeeDiploma,//职员学历
                    EmployeeJoinDate:field.employeeJoinDate,//职员加入公司日期
                    EmployeeAdd:field.employeeAdd,//职员家庭住址
                    EmployeePhone:field.employeePhone,//职员固定电话
                    EmployeeMobile:field.employeeMobile,//职员移动电话
                    DepartmentId:field.departmentId,//职员所属部门编号
                    JobsId:field.jobsId//职员的职务编号
                }
                $.post('/Logistic/AddEmployeeinfotable',obj,function(data){
                    if(data=="success"){
                        layer.msg("添加成功",{icon:1,offset:'15px',time: 1000},function(){
                            var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
                            parent.layer.close(index);//关闭弹出的子页面窗口
                            parent.location.reload(); // 父页面刷新
                        });
                    }else{
                        layer.msg("添加失败",{icon:2,offset:'15px',time: 1000,anim:6},function(){
                            var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
                            parent.layer.close(index);//关闭弹出的子页面窗口
                            parent.location.reload(); // 父页面刷新
                        });
                    }
                },"text")
            }
            return false;

        })

    })

    //下拉框加载函数
    function loadSelect($,form){
        //职务下拉框
        $.post("/Logistic/selectJobsName",function(data){
            for(var i=0;i<data.length;i++){
                $('#jobsId').append(new Option(data[i].jobsName, data[i].jobsId));// 下拉菜单里添加元素
            }
            form.render(); //更新全部
        },"json");
        //学历下拉框
        $.post("/Logistic/selectDiplomaName",function(data){
            for(var i=0;i<data.length;i++){
                $('#employeeDiploma').append(new Option(data[i].diplomaName, data[i].id));// 下拉菜单里添加元素
            }
            form.render(); //更新全部
        },"json");
        //部门下拉框
        $.post("/Logistic/selectDepartmentName",function(data){
            $.each(data,function (index, item) {
                $('#departmentId').append(new Option(item.departmentName, item.departmentId));// 下拉菜单里添加元素
            });
            form.render(); //更新全部
        },"json");
        //form.render(); //更新全部
        //form.render('select'); //刷新select选择框渲染
    }

    //日期加载函数
    function loadLaydate(laydate){
        //出生日期
        laydate.render({
            elem: '#employeeBirthDate'
            ,calendar: true
        });
        //加入公司时间
        laydate.render({
            elem: '#employeeJoinDate'
            ,calendar: true
        });
    }
</script>